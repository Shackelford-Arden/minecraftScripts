<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Project Blocky</title>
    <link rel="stylesheet" type="text/css" href="materialize/css/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="styles/terminal.css">
    <link rel="stylesheet" type="text/css" href="styles/main.css">
    <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <!-- <script src="node_modules/socket.io-client/dist/socket.io.js"></script> -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="index.js"></script>
</head>

<body class="blue-grey darken-3">

<script>
  console.log("We are in the setup");
//   var socket =  io.connect("//64.52.84.42:8080");
  var socket =  io.connect(window.location.hostname+":8080");
  socket.on("connected", function(){
      console.log("Connection was made!");
      });
    socket.on("version",function(data){
        vanillaVer = data;
    })
    socket.on("stdOut",function(data){
        console.log(data);
        var SN = data.name
        var term = document.getElementById(SN+"-stdout")
        term.innerHTML += data.log;
        term.scrollTop=term.scrollHeight
    })
    socket.on("servers",function(servers){
        console.log("recieved server list: ",servers)
        $('#serverList')[0].innerHTML=null;
        for(s in servers){
            console.log("creating server: ",s)
            createServerExpandable(s);
            var term = document.getElementById(s+"-stdout")
            for(l in servers[s].log){
                term.innerHTML += servers[s].log[l];
                term.scrollTop=term.scrollHeight
                
            }
        }
    })
    function createServer(){
        var data = {
            servername:document.querySelector('#name').value,
            maxMem:document.querySelector('#maxMem').value,
            minMem:document.querySelector('#minMem').value,
            vanilla:document.querySelector('#vanillaVer').value,
            forge:document.querySelector('#forgeVer').value,
            isForge:document.querySelector('#forgeCheckbox').checked ? true:false
        }
        console.log("Creating Server",data)
        socket.emit("createServer",data)
    }
    function startServer(SN){
      console.log("startingServer:",SN)
      var data={name:SN}
      socket.emit("startServer",data);
    }
    function stopServer(SN){
        console.log("stopingServer:",SN)
        var data={name:SN}
        socket.emit("stopServer",data);
    }
    function editServer(){
        console.log("Gonna edit something")
    }
    function uninstallServer(){
        console.log("removing server installation")
        socket.emit("uninstallServer");
    }

    function installServer(){
        console.log("creating server installation")
        socket.emit("installServer");
    }
  
</script>

    <nav class="nav-extended">

        <div class="nav-wrapper  blue-grey darken-1">
            <a href="#" class="brand-logo center"><strong>Project Blocky</strong></a>
            <ul id="nav-mobile" class="right hide-on-med-and-down">
                <li><a href="#">Account</a></li>
                <li><a href="#">Sign Out</a></li>
            </ul>

        </div>
        <div class="nav-content blue-grey darken-2">

            <ul class="tabs tabs-transparent">

                <li class="tab"><a href="#dashboard" class="active">Dashboard</a></li>
                <li class="tab"><a href="#stats">Server Stats</a></li>
                <li class="tab"><a href="#users">User Management</a></li>
                <li class="tab"><a href="#backups">Backups</a></li>
                <li class="tab"><a href="#commands">Commands</a></li>
                <li class="tab"><a href="#map">World Map</a></li>

            </ul>

        </div>

    </nav>

    <main class="container">
        <section class="row flow-text col s12 m6">
            <h1 class="transparent center-align orange-text">Project Blocky</h1>

            <div class="row card blue-grey lighten-1">
                <div class="card-content white-text">
                    <span class="card-title"><h2>What is it?</h2></span>
                    <p>This little project is our endeavor to make our mining habits a much simpler thing to manage. We opted to do this ourselves since others seemed to be lacking in features and of course... Material Design. That and Wes is super awesome and did some cool stuff on the backend.</p>
                </div>
            </div>

            <div class="row card blue-grey lighten-1">
                <div class="card-content white-text">
                    <div class="card-title">Create New Server</div>
                    <form action="#">
                        <div class="row">
                            <div class="input-field col s6">
                                <input name="name" id="name" type="text">
                                <label for="name">Server Name</label>
                            </div>
                            <div class="input-field col s3">
                                <input name="maxRam" id="maxMem" type="text">
                                <label for="maxRam">Max Ram</label>
                            </div>
                            <div class="input-field col s3">
                                <input name="maxRam" id="minMem" type="text">
                                <label for="minRam">Min Ram</label>
                            </div>
                        </div>
                        <div class="row">
                            <div class="input-field col s2">
                                <label>MC Version</label>       
                                <select id="vanillaVer" class="">
                                    <option value="" disabled selected></option>
                                    <option value="1.12.2">1.12.2</option>
                                    <option value="1.12.1">1.12.1</option>
                                    <option value="1.11.1">1.11.1</option>
                                </select>
                            </div>
                            <div class="input-field col s3">
                                <label>Forge Version</label>  
                                <select id="forgeVer" class="">
                                    <option value="" disabled selected></option>
                                    <option value="1.12.1">1.12.1</option>
                                    <option value="1.112.1">1.112.1</option>
                                    <option value="1.11.1">1.11.1</option>
                                </select>
                            </div>
                            <div class="input-field col s5">
                                <input type="checkbox" id="forgeCheckbox">
                                <label for="forgeCheckbox">Create Forge Server</label>
                            </div>
                        </div>
                        <div class="row">
                            <button onclick="createServer()" class="btn waves-light right">Create Server</button>
                        </div>
                    </form>
                </div>
            </div>
            <div class="row card blue-grey lighten-1">
                <div class="card-content white-text">
                    <span class="card-title"><h3>The Beginning and End...</h3></span>
                    <p>Go ahead... click one... you know you want to.</p>
                    <ul id="serverList" class="collapsible" data-collapsible="expandable">
                            <li>
                                <div class="collapsible-header">
                                    <!-- Minecraft Server -->
                                    <div class="serverName">MinecraftServer</div>
                                    <div class="serverStatus"></div>
                                    <div class="spacer"></div>
                                    <div class="startServer"><a class="waves-effect waves-light btn" onclick="startServer()">Start Server</a></div>
                                    <div class="stopServer"><a class="waves-effect waves-light btn" onclick="stopServer()">Stop Server</a></div>
                                </div>
                                <div class="collapsible-body">
                                    <div class="terminal space shadow">
                                            <div class="top">
                                                <div class="btns">
                                                    <span class="circle red"></span>
                                                    <span class="circle yellow"></span>
                                                    <span class="circle green"></span>
                                                </div>
                                                <div class="title">Minecraft Server</div>
                                            </div>
                                            <pre id="serverOutput" class="body">
                                            </pre>
                                        </div>
                                </div>
                            </li>
                            <li>
                                <div class="collapsible-header">
                                    <!-- Minecraft Server -->
                                    <div class="serverName">MinecraftServer</div>
                                    <div class="serverStatus"></div>
                                    <div class="startServer"><a class="waves-effect waves-light btn" onclick="startServer()">Start Server</a></div>
                                    <div class="stopServer"><a class="waves-effect waves-light btn" onclick="stopServer()">Stop Server</a></div>
                                </div>
                                <div class="collapsible-body">
                                    <div class="terminal space shadow">
                                            <div class="top">
                                                <div class="btns">
                                                    <span class="circle red"></span>
                                                    <span class="circle yellow"></span>
                                                    <span class="circle green"></span>
                                                </div>
                                                <div class="title">Minecraft Server</div>
                                            </div>
                                            <pre class="body">
                                            </pre>
                                        </div>
                                </div>
                            </li>
                            <li>
                                <div class="collapsible-header">
                                    <!-- Minecraft Server -->
                                    <div class="serverName">MinecraftServer</div>
                                    <div class="serverStatus"></div>
                                    <div class="startServer"><a class="waves-effect waves-light btn" onclick="startServer()">Start Server</a></div>
                                    <div class="stopServer"><a class="waves-effect waves-light btn" onclick="stopServer()">Stop Server</a></div>
                                </div>
                                <div class="collapsible-body">
                                    <div class="terminal space shadow">
                                            <div class="top">
                                                <div class="btns">
                                                    <span class="circle red"></span>
                                                    <span class="circle yellow"></span>
                                                    <span class="circle green"></span>
                                                </div>
                                                <div class="title">Minecraft Server</div>
                                            </div>
                                            <pre class="body">
                                            </pre>
                                        </div>
                                </div>
                            </li>
                    </ul>
                    <!-- <a class="waves-effect waves-light btn" onclick="uninstallServer()">Uninstall Server</a> -->
                    <!-- <a class="waves-effect waves-light btn" onclick="installServer()">Install Forge Server</a> -->
                </div>
            </div>

            <div class="row card blue-grey lighten-1">
                <div class="card-content white-text">
                    <span class="card-title"><h3>Good ol' Backups</h3></span>
                    <p>Always need a good backup plan. Never know when something will go wrong...</p>
                    <a class="waves-effect waves-light btn" onclick="makeToast()">Run a Backup</a>
                </div>
            </div>

        </section>

    </main>
</body>

</html>
<script src="materialize/js/materialize.min.js"></script>
<script type="application/javascript">

    function makeToast() {
        Materialize.toast('This does not work yet :(', 5000, 'rounded');
    }
</script>
